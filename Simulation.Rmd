---
title: "Simulation"
output: rmarkdown::github_document
date: "2023-12-09"
---

Singular value decomposition ${\rm SVD}_k$:
```{r}
SVD = function(k, X){
  svd_result <- svd(X)
  U <- svd_result$u
  d <- svd_result$d
  V <- svd_result$v
  d[-(1:k)] <- 0
  return(U %*% diag(d, nrow(X), ncol(X)) %*% t(V))
}
```

Soft-threshold operator ${\rm S}_{\lambda}$:
```{r}
Soft_threshold = function(lambda, X){
  svd_result <- svd(X)
  U <- svd_result$u
  d <- svd_result$d
  V <- svd_result$v
  d <- (d - lambda)*((d - lambda) > 0)
  return(U %*% diag(d, nrow(X), ncol(X)) %*% t(V))
}
```

Data Generation:
```{r}
set.seed(1)
n = 1000
p = 100
r = 70
sigma = 1

A <- matrix(rnorm(n*r), n, r)
B <- matrix(rnorm(p*r), p, r)
err <- matrix(rnorm(n*p, 0, sigma^2), n, p)
W <- matrix(runif(n*p), n, p)
M <- A %*% t(B) + err
M[1:3,1:3]
```
